#!/usr/bin/env python
from subprocess import check_output, call
from argparse import ArgumentParser
from os.path import splitext
import colors


def main():
    options = get_options()

    files = check_output(['git', 'ls-files']).strip().split('\n')
    files.sort()
    if options.c:
        file_dict = {}
        for f in files:
            key = splitext(f)[1]
            if key not in file_dict:
                file_dict[key] = []
            file_dict[key].append(f)

        first = True
        for key in sorted(file_dict):
            if first:
                first = False
            else:
                print
            if key:
                print colors.green(colors.bold(key))
            else:
                print colors.green(colors.bold('no extension'))
            for f in file_dict[key]:
                print '  ' + f
    else:
        call(['ls', '-lahF', '--color=auto'] + files)


def get_options():
    parser = ArgumentParser()
    parser.add_argument('-c', action='store_true',
                        help='Categorize file by extension')
    return parser.parse_args()


if __name__ == '__main__':
    main()
